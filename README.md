# üì¨ Chapter 06: Notification Service for Driver Alerts

## üåü **Chapter Summary**
This chapter introduces the **Notification Service**, which is responsible for sending email notifications to drivers whenever a bin is assigned or unassigned.  
It integrates with Kafka to consume assignment events generated by the **Driver Assignment Service**, retrieves relevant bin information, and dispatches email alerts in real time.

---

## ‚öôÔ∏è **Service Components**

### 1. **Kafka Consumer Configuration**
- Listens to the `assignment-notif` topic.
- Uses `ConcurrentKafkaListenerContainerFactory` with **manual acknowledgment**.
- Deserializes `AssignmentNotif` messages from Kafka using `JsonDeserializer`.

### 2. **Assignment Notification Consumer**
- Consumes messages from Kafka (`assignment-notif` topic).
- Logs received notifications (driver ID, email, bin ID).
- Delegates to the `NotificationService` to send emails.

### 3. **Notification Service**
- Fetches bin details (like location) using `BinClient`.
- Uses `MailSenderService` to generate and send emails.
- Emails include the type of notification (assignment or unassignment), bin ID, and location.

### 4. **Mail Sender Service**
- Integrates with **Spring Mail** and **Thymeleaf** templates.
- Builds HTML email content dynamically using the notification data.
- Configurable sender address and email subject via application properties.

---

## üîÑ **Communication Flow**

1. **Driver Assignment Service**
   - Assigns or unassigns a bin to a driver.
   - Publishes an `AssignmentNotif` message to the `assignment-notif` Kafka topic.

2. **Notification Service**
   - Listens to `assignment-notif` topic.
   - Fetches bin location via `BinClient`.
   - Sends an email notification to the driver.

3. **Driver**
   - Receives email notifications about new assignments or unassignments.

---

## üìù **Key Features**
- Asynchronous processing via Kafka.
- Automatic email notification for bin assignments/unassignments.
- Dynamic email content using Thymeleaf templates.
- Separation of concerns: consumer, service, and mail sender are modular.

---
